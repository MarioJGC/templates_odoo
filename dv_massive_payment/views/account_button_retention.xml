<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="view_out_invoice_tree_inherit_module_account" model="ir.ui.view">
        <field name="name">model.out.invoice.view.form.inherit</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_out_invoice_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//tree/header" position="inside">
                <button name="register_payment" groups="account.group_account_invoice,dv_account_letter.group_tesorery" type="object" string="Pago Masivo" class="oe_highlight" invisible="context.get('default_move_type') not in ('out_invoice', 'out_refund', 'out_receipt', 'in_invoice', 'in_refund','in_receipt')"/>
            </xpath>
        </field>
    </record>

    <record id="view_out_invoice_form" model="ir.ui.view">
        <field name="name">model.view_out_invoice_form</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='action_register_payment']" position="after">
                <button name="register_payment" type="object" string="Pago Masivo" class="oe_highlight" groups="account.group_account_invoice,dv_account_letter.group_tesorery"
                invisible="state != 'posted' or payment_state not in ('not_paid', 'partial') or move_type not in ('out_invoice')"
                context="{'active_model': 'account.move', 'active_ids': [id]}"/>
            </xpath>
        </field>
    </record>

</odoo>
